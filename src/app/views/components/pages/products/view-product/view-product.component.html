
<div *ngIf="service" class="p-4 rounded-lg shadow-lg mx-auto bg-white flex flex-col lg:flex-row">
    <div class="lg:w-1/2">
        <div class="ml-6">
            <app-breadcrumb [items]="items"></app-breadcrumb>
        </div>
        <p-carousel [value]="imagesService" [numVisible]="1" [numScroll]="1" orientation="horizontal"
            verticalViewPortHeight="370px">
            <ng-template let-imageService pTemplate="item">
                <div class="border-1 surface-border border-round m-2 p-3">
                    <div class="mb-3">
                        <div class="relative mx-auto">
                            <img [src]="storage + imageService.path" [alt]="service.name" class="w-full border-round" />
                        </div>
                    </div>
                </div>
            </ng-template>
        </p-carousel>
        <div *ngIf="user" class="ml-7">
            <h2 class="text-lg font-bold">{{ user.first_name }}</h2>
            <a [href]="'mailto:' + user.email" class="text-sm text-gray-500">{{ user.email }}</a>
        </div>
    </div>


    <div class="lg:w-1/2 lg:pl-6 mt-4 lg:mt-0">
        <h3 class="text-xl font-semibold">{{ service.name }}</h3>
        <p>Ubicación: {{ service.municipality?.name }}</p>

        <div class="flex items-center mt-2">
            <p-rating [stars]="5" [(ngModel)]="service.reviews_avg_rating" [readonly]="true" [cancel]="false"></p-rating><h4 class="mb-5 ml-2">({{ service.reviews?.length }})</h4>
        </div>

        <p class="text-lg font-bold text-gray-800 mt-2">${{ service.price | number:'1.0-0' }}</p>

        <p-accordion>
            <p-accordionTab header="Descripción">
                <p>{{ service?.description }}</p>
            </p-accordionTab>
            <p-accordionTab header="Comentarios">
                <div *ngIf="service?.reviews && (service.reviews && service.reviews.length > 0); else noComments">
                    <div *ngFor="let review of service.reviews" class="border-b border-gray-200 py-3">
                        <div class="flex items-center mb-2">
                            <p-rating [stars]="5" [(ngModel)]="review.rating" [readonly]="true" class="mr-2 small-rating" [cancel]="false"></p-rating>
                            <span class="text-sm text-gray-500">{{ review.created_at | date: 'shortDate' }}</span>
                        </div>
                        <p class="text-gray-800">{{ review.comment }}</p>
                    </div>
                </div>
                <ng-template #noComments>
                    <p class="text-gray-500">Aún no hay comentarios.</p>
                </ng-template>
            </p-accordionTab>
        </p-accordion>
        <div class="mt-3">
            <h6>Seleccione un horario</h6>
            <p-calendar 
                [(ngModel)]="date" 
                [timeOnly]="true"
                inputId="templatedisplay"
                hourFormat="24">
            </p-calendar>
        </div>
        <p-toast key="tst" [baseZIndex]="99999"></p-toast>
        <button pButton label="Contratar" class="w-full mt-4 bg-indigo-600 text-white py-2 rounded-lg"
            (click)="checkAvailability()"></button>
    </div>
</div>